(function(){this.App=angular.module("app",["ui.router","restangular"])}).call(this),function(){App.config(function(RestangularProvider){return RestangularProvider.setBaseUrl("http://server.sitenotify.dev/api")}),App.run(function(Restangular,$state){return Restangular.setErrorInterceptor(function(response){var _ref;return 422!==(_ref=response.status)&&401!==_ref&&404!==_ref?(alert("Unable to process this request"),!1):401===response.status?($state.go("special.login"),!1):404===response.status?(alert("Unable to contact server. Make sure your internet connection is fine."),!1):!0})})}.call(this),function(){App.config(function($stateProvider,$urlRouterProvider){return $urlRouterProvider.otherwise("/not_found"),$stateProvider.state("special",{templateUrl:"views/layouts/special.html"}).state("special.login",{url:"/login",templateUrl:"views/generic/login.html"}).state("special.signup",{url:"/signup",templateUrl:"views/generic/signup.html"}).state("not_found",{url:"/not_found",templateUrl:"views/generic/not_found.html"}),$stateProvider.state("dashboard",{templateUrl:"views/layouts/dashboard.html",resolve:{currentUser:function(UserService){return UserService.currentUser||UserService.refresh()}}}).state("dashboard.home",{url:"/dashboard"}),$stateProvider.state("main",{url:""}).state("main2",{url:"/"})})}.call(this),function(){App.controller("NavCtrl",function($scope,UserService){return $scope.user=UserService.currentUser})}.call(this),function(){App.controller("LoginCtrl",function($scope,Restangular,UserService,$state){return $scope.login=function(user){return Restangular.all("sessions").post(user).then(function(data){return UserService.setUser(data.user),$state.go("dashboard.home")},function(){return $scope.error="Invalid email or password"})}})}.call(this),function(){App.controller("SignupCtrl",function($scope,Restangular,ErrorService,UserService,$state){return $scope.signup=function(user){return console.log(user),Restangular.all("users").post(user).then(function(data){return UserService.setUser(data),$state.go("dashboard.home")},function(response){return $scope.errors=ErrorService.fullMessages(response)})}})}.call(this),function(){App.service("ErrorService",function(){return{fullMessages:function(response){var field,msgs,value,_ref;msgs=[],_ref=response.data.errors;for(field in _ref)value=_ref[field],msgs.push(""+field+" "+value[0]);return msgs}}})}.call(this),function(){App.service("UserService",function(Restangular){return this.currentUser=null,this.setUser=function(currentUser){this.currentUser=null!=currentUser?currentUser:user},this.refresh=function(){return Restangular.all("users").customGET("details").then(function(_this){return function(data){return _this.currentUser=data.user}}(this))},this})}.call(this);